# Facebook Event Extractor Bookmarklet - Installation Instructions

## âš ï¸ IMPORTANT: Do NOT paste this into the address bar!

The bookmarklet code needs to be saved as a bookmark, not pasted into the address bar.

## ğŸ“‹ Step-by-Step Installation:

### Method 1: Create Bookmark Manually
1. **Right-click** on your browser's bookmarks bar
2. **Select** "Add bookmark" or "New bookmark"
3. **Name**: `Facebook Event Extractor`
4. **URL**: Copy the ENTIRE line below (including `javascript:`):

```javascript
javascript:(function(){const modal=document.createElement('div');modal.id='event-extractor-modal';modal.style.cssText='position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:500px;max-height:80vh;overflow-y:auto;background:white;border:2px solid #8b4aff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.3);z-index:10000;font-family:Arial,sans-serif;padding:20px;';const backdrop=document.createElement('div');backdrop.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:9999;';function extractEventData(){const eventData={title:'',date:'',time:'',venue:'',description:'',organizer:'',url:window.location.href,extracted_at:new Date().toISOString()};try{const titleSelectors=['[data-testid="event-permalink-event-name"] h1','[data-testid="event-permalink-event-name"]','h1[data-testid="event-permalink-event-name"]','.x1heor9g .x1qlqyl8','h1'];for(const selector of titleSelectors){const titleEl=document.querySelector(selector);if(titleEl&&titleEl.textContent.trim()){eventData.title=titleEl.textContent.trim();break;}}const dateTimeSelectors=['[data-testid="event-permalink-details"] span','.x1i10hfl time','time','.event-date-time','.date-time-info'];let dateTimeText='';for(const selector of dateTimeSelectors){const elements=document.querySelectorAll(selector);for(const el of elements){const text=el.textContent.trim();if(text&&(text.includes('202')||text.includes('AM')||text.includes('PM'))){dateTimeText+=text+' ';}}if(dateTimeText)break;}const datePattern=/(\w+day,?\s+\w+\s+\d{1,2},?\s+\d{4})/i;const timePattern=/(\d{1,2}:\d{2}\s*(?:AM|PM))/i;const dateMatch=dateTimeText.match(datePattern);const timeMatch=dateTimeText.match(timePattern);if(dateMatch)eventData.date=dateMatch[1];if(timeMatch)eventData.time=timeMatch[1];const locationSelectors=['[data-testid="event-permalink-details"] a[href*="maps"]','.event-location','.venue-name','a[href*="maps.google"]','a[href*="facebook.com/pages"]'];for(const selector of locationSelectors){const locationEl=document.querySelector(selector);if(locationEl&&locationEl.textContent.trim()){eventData.venue=locationEl.textContent.trim();break;}}const organizerSelectors=['[data-testid="event-permalink-organizer"] a','.event-organizer a','.hosted-by a','a[role="link"][href*="/events"]'];for(const selector of organizerSelectors){const organizerEl=document.querySelector(selector);if(organizerEl&&organizerEl.textContent.trim()){eventData.organizer=organizerEl.textContent.trim();break;}}const descSelectors=['[data-testid="event-permalink-description"]','.event-description','.description-text'];for(const selector of descSelectors){const descEl=document.querySelector(selector);if(descEl&&descEl.textContent.trim()){eventData.description=descEl.textContent.trim().substring(0,300);break;}}}catch(error){console.error('Error extracting event data:',error);}return eventData;}function detectGenre(eventData){const content=(eventData.title+' '+eventData.description+' '+eventData.organizer).toLowerCase();const genreKeywords={'house':['house','deep house','tech house','progressive house'],'drum-and-bass':['drum and bass','dnb','liquid','neurofunk'],'ukg':['uk garage','garage','ukg','2-step'],'dubstep':['dubstep','bass music','riddim','future bass'],'trance':['trance','progressive trance','uplifting','psytrance'],'techno':['techno','minimal','industrial','detroit techno']};for(const [genre,keywords] of Object.entries(genreKeywords)){if(keywords.some(keyword=>content.includes(keyword))){return genre;}}return 'other';}const eventData=extractEventData();const detectedGenre=detectGenre(eventData);const jsonData={source:'facebook_bookmarklet',event_title:eventData.title,event_date:eventData.date,event_time:eventData.time,venue_name:eventData.venue,promoter:eventData.organizer,genre:detectedGenre,description:eventData.description,ticket_url:eventData.url,extracted_at:eventData.extracted_at};modal.innerHTML=`<div style="border-bottom: 2px solid #8b4aff; padding-bottom: 15px; margin-bottom: 20px;"><h2 style="color: #8b4aff; margin: 0; font-size: 20px;">ğŸµ Facebook Event Extractor</h2></div><div style="margin-bottom: 20px;"><h3 style="color: #333; margin-bottom: 10px;">ğŸ“Š Extracted Event Data:</h3><div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;"><div style="margin-bottom: 8px;"><strong>Title:</strong> ${eventData.title||'Not found'}</div><div style="margin-bottom: 8px;"><strong>Date:</strong> ${eventData.date||'Not found'}</div><div style="margin-bottom: 8px;"><strong>Time:</strong> ${eventData.time||'Not found'}</div><div style="margin-bottom: 8px;"><strong>Venue:</strong> ${eventData.venue||'Not found'}</div><div style="margin-bottom: 8px;"><strong>Organizer:</strong> ${eventData.organizer||'Not found'}</div><div style="margin-bottom: 8px;"><strong>Detected Genre:</strong> <span style="background: #8b4aff; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">${detectedGenre}</span></div><div style="margin-bottom: 8px;"><strong>URL:</strong> <a href="${eventData.url}" target="_blank" style="color: #8b4aff;">Event Link</a></div></div>${eventData.description?`<div style="margin-bottom: 15px;"><strong>Description Preview:</strong><div style="background: #f0f0f0; padding: 10px; border-radius: 4px; font-size: 12px; max-height: 100px; overflow-y: auto;">${eventData.description}...</div></div>`:''}</div><div style="margin-bottom: 20px;"><h3 style="color: #333; margin-bottom: 10px;">ğŸ“§ Send to Import System:</h3><textarea id="json-output" style="width: 100%; height: 120px; font-family: monospace; font-size: 11px; border: 1px solid #ddd; border-radius: 4px; padding: 8px;" readonly>${JSON.stringify(jsonData,null,2)}</textarea></div><div style="display: flex; gap: 10px; margin-top: 20px;"><button id="copy-json" style="background: #8b4aff; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; font-weight: bold;">ğŸ“‹ Copy Data</button><button id="send-to-system" style="background: #28a745; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; font-weight: bold;">ğŸ“¤ Send to System</button><button id="close-modal" style="background: #6c757d; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; font-weight: bold;">âŒ Close</button></div><div style="margin-top: 15px; padding: 10px; background: #e3f2fd; border-radius: 4px; font-size: 12px;">ğŸ’¡ <strong>Tip:</strong> Use Facebook's "Export Event" feature to email events directly to <code>lxwupbiw@mailparser.io</code>!</div>`;const copyBtn=modal.querySelector('#copy-json');const sendBtn=modal.querySelector('#send-to-system');const closeBtn=modal.querySelector('#close-modal');const jsonOutput=modal.querySelector('#json-output');copyBtn.addEventListener('click',()=>{jsonOutput.select();document.execCommand('copy');copyBtn.textContent='âœ… Copied!';setTimeout(()=>copyBtn.textContent='ğŸ“‹ Copy Data',2000);});sendBtn.addEventListener('click',async()=>{try{sendBtn.textContent='ğŸ“¤ Sending...';const response=await fetch('http://localhost:3001/api/events/import-from-email',{method:'POST',headers:{'Content-Type':'application/json'},body:jsonOutput.value});if(response.ok){sendBtn.textContent='âœ… Sent!';sendBtn.style.background='#28a745';}else{sendBtn.textContent='âŒ Error';sendBtn.style.background='#dc3545';}setTimeout(()=>{sendBtn.textContent='ğŸ“¤ Send to System';sendBtn.style.background='#28a745';},3000);}catch(error){console.error('Error sending data:',error);sendBtn.textContent='âŒ CORS Error';sendBtn.style.background='#dc3545';const errorDiv=document.createElement('div');errorDiv.style.cssText='margin-top: 10px; padding: 10px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; font-size: 12px;';errorDiv.innerHTML='<strong>âš ï¸ Browser Security Block:</strong><br>The browser blocked the request from Facebook to localhost. Please <strong>copy the data</strong> and manually paste it into your admin system at:<br><a href="http://localhost:3001/admin/import-review" target="_blank" style="color: #8b4aff;">http://localhost:3001/admin/import-review</a>';modal.appendChild(errorDiv);}});function closeModal(){document.body.removeChild(backdrop);document.body.removeChild(modal);}closeBtn.addEventListener('click',closeModal);backdrop.addEventListener('click',closeModal);document.body.appendChild(backdrop);document.body.appendChild(modal);})();
```

### Method 2: Drag and Drop (Chrome/Edge)
1. **Select and drag** the link below to your bookmarks bar:
   
   <a href="javascript:(function(){const modal=document.createElement('div');modal.id='event-extractor-modal';modal.style.cssText='position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:500px;max-height:80vh;overflow-y:auto;background:white;border:2px solid #8b4aff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.3);z-index:10000;font-family:Arial,sans-serif;padding:20px;';const backdrop=document.createElement('div');backdrop.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:9999;';function extractEventData(){const eventData={title:'',date:'',time:'',venue:'',description:'',organizer:'',url:window.location.href,extracted_at:new Date().toISOString()};try{const titleSelectors=['[data-testid=\"event-permalink-event-name\"] h1','[data-testid=\"event-permalink-event-name\"]','h1[data-testid=\"event-permalink-event-name\"]','.x1heor9g .x1qlqyl8','h1'];for(const selector of titleSelectors){const titleEl=document.querySelector(selector);if(titleEl&&titleEl.textContent.trim()){eventData.title=titleEl.textContent.trim();break;}}const dateTimeSelectors=['[data-testid=\"event-permalink-details\"] span','.x1i10hfl time','time','.event-date-time','.date-time-info'];let dateTimeText='';for(const selector of dateTimeSelectors){const elements=document.querySelectorAll(selector);for(const el of elements){const text=el.textContent.trim();if(text&&(text.includes('202')||text.includes('AM')||text.includes('PM'))){dateTimeText+=text+' ';}}if(dateTimeText)break;}const datePattern=/(\w+day,?\s+\w+\s+\d{1,2},?\s+\d{4})/i;const timePattern=/(\d{1,2}:\d{2}\s*(?:AM|PM))/i;const dateMatch=dateTimeText.match(datePattern);const timeMatch=dateTimeText.match(timePattern);if(dateMatch)eventData.date=dateMatch[1];if(timeMatch)eventData.time=timeMatch[1];const locationSelectors=['[data-testid=\"event-permalink-details\"] a[href*=\"maps\"]','.event-location','.venue-name','a[href*=\"maps.google\"]','a[href*=\"facebook.com/pages\"]'];for(const selector of locationSelectors){const locationEl=document.querySelector(selector);if(locationEl&&locationEl.textContent.trim()){eventData.venue=locationEl.textContent.trim();break;}}const organizerSelectors=['[data-testid=\"event-permalink-organizer\"] a','.event-organizer a','.hosted-by a','a[role=\"link\"][href*=\"/events\"]'];for(const selector of organizerSelectors){const organizerEl=document.querySelector(selector);if(organizerEl&&organizerEl.textContent.trim()){eventData.organizer=organizerEl.textContent.trim();break;}}const descSelectors=['[data-testid=\"event-permalink-description\"]','.event-description','.description-text'];for(const selector of descSelectors){const descEl=document.querySelector(selector);if(descEl&&descEl.textContent.trim()){eventData.description=descEl.textContent.trim().substring(0,300);break;}}}catch(error){console.error('Error extracting event data:',error);}return eventData;}function detectGenre(eventData){const content=(eventData.title+' '+eventData.description+' '+eventData.organizer).toLowerCase();const genreKeywords={'house':['house','deep house','tech house','progressive house'],'drum-and-bass':['drum and bass','dnb','liquid','neurofunk'],'ukg':['uk garage','garage','ukg','2-step'],'dubstep':['dubstep','bass music','riddim','future bass'],'trance':['trance','progressive trance','uplifting','psytrance'],'techno':['techno','minimal','industrial','detroit techno']};for(const [genre,keywords] of Object.entries(genreKeywords)){if(keywords.some(keyword=>content.includes(keyword))){return genre;}}return 'other';}const eventData=extractEventData();const detectedGenre=detectGenre(eventData);const jsonData={source:'facebook_bookmarklet',event_title:eventData.title,event_date:eventData.date,event_time:eventData.time,venue_name:eventData.venue,promoter:eventData.organizer,genre:detectedGenre,description:eventData.description,ticket_url:eventData.url,extracted_at:eventData.extracted_at};modal.innerHTML=\`<div style=\"border-bottom: 2px solid #8b4aff; padding-bottom: 15px; margin-bottom: 20px;\"><h2 style=\"color: #8b4aff; margin: 0; font-size: 20px;\">ğŸµ Facebook Event Extractor</h2></div><div style=\"margin-bottom: 20px;\"><h3 style=\"color: #333; margin-bottom: 10px;\">ğŸ“Š Extracted Event Data:</h3><div style=\"background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;\"><div style=\"margin-bottom: 8px;\"><strong>Title:</strong> \${eventData.title||'Not found'}</div><div style=\"margin-bottom: 8px;\"><strong>Date:</strong> \${eventData.date||'Not found'}</div><div style=\"margin-bottom: 8px;\"><strong>Time:</strong> \${eventData.time||'Not found'}</div><div style=\"margin-bottom: 8px;\"><strong>Venue:</strong> \${eventData.venue||'Not found'}</div><div style=\"margin-bottom: 8px;\"><strong>Organizer:</strong> \${eventData.organizer||'Not found'}</div><div style=\"margin-bottom: 8px;\"><strong>Detected Genre:</strong> <span style=\"background: #8b4aff; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;\">\${detectedGenre}</span></div><div style=\"margin-bottom: 8px;\"><strong>URL:</strong> <a href=\"\${eventData.url}\" target=\"_blank\" style=\"color: #8b4aff;\">Event Link</a></div></div>\${eventData.description?\`<div style=\"margin-bottom: 15px;\"><strong>Description Preview:</strong><div style=\"background: #f0f0f0; padding: 10px; border-radius: 4px; font-size: 12px; max-height: 100px; overflow-y: auto;\">\${eventData.description}...</div></div>\":''}</div><div style=\"margin-bottom: 20px;\"><h3 style=\"color: #333; margin-bottom: 10px;\">ğŸ“§ Send to Import System:</h3><textarea id=\"json-output\" style=\"width: 100%; height: 120px; font-family: monospace; font-size: 11px; border: 1px solid #ddd; border-radius: 4px; padding: 8px;\" readonly>\${JSON.stringify(jsonData,null,2)}</textarea></div><div style=\"display: flex; gap: 10px; margin-top: 20px;\"><button id=\"copy-json\" style=\"background: #8b4aff; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; font-weight: bold;\">ğŸ“‹ Copy Data</button><button id=\"send-to-system\" style=\"background: #28a745; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; font-weight: bold;\">ğŸ“¤ Send to System</button><button id=\"close-modal\" style=\"background: #6c757d; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; font-weight: bold;\">âŒ Close</button></div><div style=\"margin-top: 15px; padding: 10px; background: #e3f2fd; border-radius: 4px; font-size: 12px;\">ğŸ’¡ <strong>Tip:</strong> Use Facebook's \"Export Event\" feature to email events directly to <code>lxwupbiw@mailparser.io</code>!</div>\`;const copyBtn=modal.querySelector('#copy-json');const sendBtn=modal.querySelector('#send-to-system');const closeBtn=modal.querySelector('#close-modal');const jsonOutput=modal.querySelector('#json-output');copyBtn.addEventListener('click',()=>{jsonOutput.select();document.execCommand('copy');copyBtn.textContent='âœ… Copied!';setTimeout(()=>copyBtn.textContent='ğŸ“‹ Copy Data',2000);});sendBtn.addEventListener('click',async()=>{try{sendBtn.textContent='ğŸ“¤ Sending...';const response=await fetch('http://localhost:3001/api/events/import-from-email',{method:'POST',headers:{'Content-Type':'application/json'},body:jsonOutput.value});if(response.ok){sendBtn.textContent='âœ… Sent!';sendBtn.style.background='#28a745';}else{sendBtn.textContent='âŒ Error';sendBtn.style.background='#dc3545';}setTimeout(()=>{sendBtn.textContent='ğŸ“¤ Send to System';sendBtn.style.background='#28a745';},3000);}catch(error){console.error('Error sending data:',error);sendBtn.textContent='âŒ CORS Error';sendBtn.style.background='#dc3545';const errorDiv=document.createElement('div');errorDiv.style.cssText='margin-top: 10px; padding: 10px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; font-size: 12px;';errorDiv.innerHTML='<strong>âš ï¸ Browser Security Block:</strong><br>The browser blocked the request from Facebook to localhost. Please <strong>copy the data</strong> and manually paste it into your admin system at:<br><a href=\"http://localhost:3001/admin/import-review\" target=\"_blank\" style=\"color: #8b4aff;\">http://localhost:3001/admin/import-review</a>';modal.appendChild(errorDiv);}});function closeModal(){document.body.removeChild(backdrop);document.body.removeChild(modal);}closeBtn.addEventListener('click',closeModal);backdrop.addEventListener('click',closeModal);document.body.appendChild(backdrop);document.body.appendChild(modal);})();">Facebook Event Extractor</a>

## ğŸ¯ How to Use:

1. **Go to any Facebook event page** (e.g., https://facebook.com/events/123456789)
2. **Click the bookmarklet** in your bookmarks bar
3. **Review** the extracted data in the popup modal
4. **Click "Send to System"** to automatically import to your system
5. Or **click "Copy Data"** and manually paste into your admin dashboard

## ğŸ”§ Troubleshooting:

- **"This site can't be reached" error**: You pasted the code into the address bar instead of creating a bookmark
- **Nothing happens**: Make sure you're on a Facebook event page, not just facebook.com
- **CORS errors**: The bookmarklet will show helpful error messages and fallback instructions

## âœ¨ What It Extracts:

- Event title
- Date and time  
- Venue/location
- Organizer/promoter
- Event description
- Automatic genre detection for electronic music
- Event URL